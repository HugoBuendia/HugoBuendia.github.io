---
import '../styles/global.css';

interface Props {
	title: string;
	description?: string;
	image?: string;
}

const {
	title,
	description = 'Hugo Buendia',
	image = '/gallery/Paula_Agari_DSC_9820.webp',
} = Astro.props;

const canonicalUrl = new URL(Astro.url.pathname, Astro.site).toString();
const previewImage = new URL(image, Astro.site).toString();
---

<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width" />
		<meta name="color-scheme" content="dark light" />
		<meta name="supported-color-schemes" content="dark light" />
		<link rel="icon" type="image/png" href="/logo_tab.png" />
		<link rel="canonical" href={canonicalUrl} />
		<meta property="og:type" content="website" />
		<meta property="og:locale" content="es_ES" />
		<meta property="og:site_name" content="Hugo Buendia" />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:url" content={canonicalUrl} />
		<meta property="og:image" content={previewImage} />
		<meta property="og:image:alt" content="Hugo Buendia" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={previewImage} />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
	</head>
	<body>
		<nav class="navbar is-hidden" id="main-navbar">
			<div class="nav-container">
				<button class="menu-toggle" id="menu-toggle" aria-label="Abrir menú" aria-controls="mobile-menu" aria-expanded="false">
					<span></span>
					<span></span>
					<span></span>
				</button>
				<div class="nav-links">
					<a href="#bio">Bio</a>
					<a href="#musica">Música</a>
					<a href="#galeria">Galería</a>
					<a href="#contacto">Contacto</a>
				</div>
			</div>
			<div class="mobile-menu" id="mobile-menu">
				<a href="#bio">Bio</a>
				<a href="#musica">Música</a>
				<a href="#galeria">Galería</a>
				<a href="#contacto">Contacto</a>
			</div>
		</nav>
		<main>
			<slot />
		</main>
	</body>
</html>

<style>
	.navbar {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		padding: 0.75rem 1.5rem;
		z-index: 100;
		background-color: var(--color-bg);
		border-bottom: 1px solid rgba(255, 255, 255, 0.1);
		opacity: 1;
		transform: translateY(0);
		transition: opacity 0.3s ease, transform 0.3s ease;
	}

	.navbar.is-hidden {
		opacity: 0;
		transform: translateY(-100%);
		pointer-events: none;
	}

	.nav-container {
		display: flex;
		justify-content: center;
		align-items: center;
		gap: 2.25rem;
		max-width: 1400px;
		margin: 0 auto;
	}

	.menu-toggle {
		display: none;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		gap: 0.3rem;
		width: 2.4rem;
		height: 2.4rem;
		background: transparent;
		border: 0;
		padding: 0;
		cursor: pointer;
	}

	.menu-toggle span {
		display: block;
		width: 1.2rem;
		height: 1px;
		background-color: var(--color-text);
		transition: transform 0.2s ease, opacity 0.2s ease;
	}

	.nav-links {
		display: flex;
		gap: 2.25rem;
		font-family: var(--font-display);
		font-size: 0.95rem;
		letter-spacing: 0.14em;
		text-transform: uppercase;
	}

	.nav-links a {
		position: relative;
		overflow: hidden;
		opacity: 0.88;
		transition: opacity 0.2s ease;
	}

	.nav-links a:hover {
		opacity: 1;
	}

	.nav-links a::after {
		content: '';
		position: absolute;
		bottom: 0;
		left: 0;
		width: 100%;
		height: 1px;
		background-color: var(--color-text);
		transform: translateX(-100%);
		transition: transform 0.3s ease;
	}

	.nav-links a:hover::after {
		transform: translateX(0);
	}

	.mobile-menu {
		display: none;
	}




	@media (max-width: 768px) {
		.navbar {
			padding: 0.75rem 1rem;
		}

		.nav-container {
			justify-content: flex-end;
			gap: 0;
		}

		.menu-toggle {
			display: flex;
		}

		.nav-links {
			display: none; /* Simple mobile nav for now */
		}

		.mobile-menu {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 1.1rem;
			padding: 0;
			max-height: 0;
			overflow: hidden;
			opacity: 0;
			background-color: var(--color-bg);
			border-bottom: 0 solid rgba(255, 255, 255, 0.1);
			transition: max-height 0.25s ease, opacity 0.2s ease, padding 0.2s ease, border-bottom-width 0.2s ease;
		}

		.mobile-menu a {
			font-family: var(--font-display);
			font-size: 0.95rem;
			letter-spacing: 0.12em;
			text-transform: uppercase;
		}

		.navbar.is-open .mobile-menu {
			max-height: 220px;
			opacity: 1;
			padding: 0.6rem 1rem 1rem;
			border-bottom-width: 1px;
		}

		.navbar.is-open .menu-toggle span:nth-child(1) {
			transform: translateY(6px) rotate(45deg);
		}

		.navbar.is-open .menu-toggle span:nth-child(2) {
			opacity: 0;
		}

		.navbar.is-open .menu-toggle span:nth-child(3) {
			transform: translateY(-6px) rotate(-45deg);
		}
	}
</style>

<script>
	const updateNavbarVisibility = () => {
		const navbar = document.getElementById('main-navbar');
		const hero = document.querySelector('.hero');
		if (!navbar || !hero) return;

		const triggerPoint = hero.clientHeight - 8;
		const shouldShow = window.scrollY >= triggerPoint;
		navbar.classList.toggle('is-hidden', !shouldShow);

		if (!shouldShow) {
			navbar.classList.remove('is-open');
			const menuToggle = document.getElementById('menu-toggle');
			if (menuToggle) {
				menuToggle.setAttribute('aria-expanded', 'false');
			}
		}
	};

	document.addEventListener('DOMContentLoaded', () => {
		const navbar = document.getElementById('main-navbar');
		const menuToggle = document.getElementById('menu-toggle');
		const mobileMenu = document.getElementById('mobile-menu');

		const closeMobileMenu = () => {
			if (!navbar || !menuToggle) return;
			navbar.classList.remove('is-open');
			menuToggle.setAttribute('aria-expanded', 'false');
		};

		if (navbar && menuToggle) {
			menuToggle.addEventListener('click', () => {
				const isOpen = navbar.classList.toggle('is-open');
				menuToggle.setAttribute('aria-expanded', String(isOpen));
			});
		}

		if (mobileMenu) {
			mobileMenu.querySelectorAll('a').forEach((link) => {
				link.addEventListener('click', closeMobileMenu);
			});
		}

		updateNavbarVisibility();
		window.addEventListener('scroll', updateNavbarVisibility, { passive: true });
		window.addEventListener('resize', () => {
			updateNavbarVisibility();
			if (window.innerWidth > 768) {
				closeMobileMenu();
			}
		});
	});
</script>

